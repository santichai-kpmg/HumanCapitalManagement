
@{
    /**/

    ViewBag.Title = "KPMG Intern | Timesheet";
    Layout = "~/Views/Shared/_TPJMaster.cshtml";
}
<div class="breadcrumb-container">
    <div class="container">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><i class="fa fa-home pr-2"></i>Profile</li>
            @*<li class="breadcrumb-item"><a href="@Url.Action("TimeSheetView", "TimeSheet", null)">TimeSheet Form</a></li>*@
            <li class="breadcrumb-item"><a href="@Url.Action("TimeSheetView", "TimeSheet", null)">Timesheet</a></li>
            <li class="breadcrumb-item active">Intern Timesheet Form</li>
        </ol>
    </div>
</div>
<div id="page-start"></div>
<!-- section end -->
<!-- section -->
<!-- ================ -->
<div class="main-container  light-translucent-bg background-img-7">
    <div class="container-fluid" style="    min-height: 55vh;
    height: 100%;">
        <div class="row">
            <div class="col-lg-12">
                <div class="card">
                    <div class="card-header">
                        <h4 class="mb-0">
                            <i class="fa fa-list-alt pr-10"></i>Intern Timesheet Form
                        </h4>
                    </div>
                    <div class="row">
                        <!-- /.col -->
                        <div class="col-md-12">
                            <div class="box box-primary">
                                <div class="box-body">
                                    <!-- THE CALENDAR -->
                                    <div class="callout ">

                                        <div class="row">
                                            <div class="col-md-6" style="background-color:#b6ebfb33;  padding: 10px; border-radius: 10px;box-shadow: 10px 6px 10px -5px rgba(0,0,0,0.24);">
                                                <h4>  <span class="fa fa-warning text-warning">&nbsp; </span><u>Additional notes :</u></h4>
                                                <ul style="list-style-type:disc;">
                                                    <li><span style="color:red;">Can't be modified after the transaction has been approved</span>.</li>
                                                    @*<li>The recording range is divided into 2 phases:<span style="color:red;">1 to 15 and 16 to the end of each month</span>.</li>*@
                                                    <li><span style="color:orange;">The minutes should be 00 or 30 only.</span></li>
                                                </ul>

                                            </div>

                                            <div class="col-md-6" style="background-color:#b6fbc833;  padding: 30px; border-radius: 10px;box-shadow: 10px 6px 10px -5px rgba(0,0,0,0.24);font-size: 18px; color: darkcyan;">
                                                @*<div class="col-md-6"><p><span>Start Date : </span><span id="startdatelb"></span></p></div>
                                                    <div class="col-md-6"><p><span>End Date : </span><span id="enddatelb"></span></p></div>*@
                                                <div class="col-md-12"><p><span>Cost Center: </span><span id="costcenterlb"></span></p></div>
                                                <div class="col-md-12"><p><span>Bank Account No. : </span><span id="accountNo"></span></p></div>



                                            </div>
                                            <div class="col-md-12" style="background-color:#fbf6b633; margin-top:10px; padding: 20px; border-radius: 10px;box-shadow: 10px 6px 10px -5px rgba(0,0,0,0.24);">
                                                It is a requirement to complete your timesheet monthly.
                                                <span class="text-danger"> For non-Audit interns, the timesheet must be completed (submitted and approved by your performance manager) 2 working days before the end of each month. Failure to complete your timesheet on time may result in late payments. </span>
                                                On the last day of the internship, please check if your timesheet, OT or reimbursement request(s) has been approved by the manager prior to returning the laptop to the IT department.
                                                <br /><br />
                                                If you have any questions or issues submitting your timesheet, please contact the system administrator.


                                            </div>
                                            <div class="col-md-6" style="border:2px solid #337ab7;padding:10px;border-radius:10px;font-size:11px; " hidden>
                                                <div class="row">
                                                    <div class="col-md-2 text-right">
                                                        <span>Name : </span>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <span id="nameshow"></span>
                                                    </div>
                                                    <div class="col-md-2 text-right">
                                                        <span>Cost Center : </span>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <span id="costcentershow"></span>
                                                    </div>
                                                </div>
                                                <hr />
                                                <div class="row">
                                                    <div class="col-md-2 text-right">
                                                        <span>Internship Date : </span>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <span id="rang_date_edit"></span>
                                                    </div>


                                                </div>

                                            </div>

                                        </div>
                                        <hr />

                                        <div class="row" style="padding-top:15px;">
                                            <div class="col-md-3 text-right">
                                                <span>Colors status : </span>
                                            </div>
                                            <div class="col-md-8">
                                                <span class="" style="background-color: #a3ada3; cursor: no-drop;color: white;padding: 10px;border-radius: 50%;">
                                                    <span class="fa fa-download"></span>
                                                </span>
                                                <span style="padding: 5px 20px 5px 40px;
    border-radius: 30px;
    border: 3px solid #a3ada3;
    margin-left: -35px;box-shadow: 10px 6px 10px -5px rgba(0,0,0,0.24);">Submitted</span>

                                                <span class="" style="background-color: #bfe87c; cursor: no-drop;color: white;padding: 10px;border-radius: 50%;">
                                                    <span class="fa fa-check"></span>
                                                </span>
                                                <span style="padding: 5px 20px 5px 40px;
    border-radius: 30px;
    border: 3px solid #bfe87c;
    margin-left: -35px;box-shadow: 10px 6px 10px -5px rgba(0,0,0,0.24);">Approved</span>

                                                <span class="" style="background-color: #8B0000; cursor: no-drop;color: white;padding: 10px;border-radius: 50%;">
                                                    <span class="fa fa-times"></span>
                                                </span>
                                                <span style="padding: 5px 20px 5px 40px;
    border-radius: 30px;
    border: 3px solid #8B0000;
    margin-left: -35px;box-shadow: 10px 6px 10px -5px rgba(0,0,0,0.24);">Revise</span>
                                                <span class="" style="background-color: #c78be6; cursor: no-drop;color: white;padding: 10px;border-radius: 50%;">
                                                    <span class="fa fa-clipboard"></span>
                                                </span>
                                                <span style="padding: 5px 20px 5px 40px;
    border-radius: 30px;
    border: 3px solid #c78be6;
    margin-left: -35px;box-shadow: 10px 6px 10px -5px rgba(0,0,0,0.24);">Awaiting Paid</span>

                                                <span class="" style="background-color: #f380ef; cursor: no-drop;color: white;padding: 10px;border-radius: 50%;">
                                                    <span class="fa fa-check-circle"></span>
                                                </span>
                                                <span style="padding: 5px 20px 5px 40px;
    border-radius: 30px;
    border: 3px solid #f380ef;
    margin-left: -35px;box-shadow: 10px 6px 10px -5px rgba(0,0,0,0.24);">Paid</span>


                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <!-- /.box-body -->
                            </div>
                            <!-- /. box -->
                        </div>
                        <!-- /.col -->
                    </div>

                    <div class="card-body">
                        <!-- Main content -->
                        <section class="content">

                            <div class="row">
                                <div class="col-md-12">
                                    <ul class="nav nav-tabs style-3" role="tablist">
                                        <li class="nav-item">
                                            <a class="nav-link active" href="#h3tab1" role="tab" data-toggle="tab">
                                                <h4 style="color: rgb(60, 141, 188);"><span class="fa fa-calendar"></span>&nbsp; Time Sheet</h4>
                                            </a>
                                        </li>
                                    </ul>
                                    <!-- Tab panes -->
                                    <div class="tab-content">
                                        <div class="tab-pane show active" role="tabpanel" id="h3tab1">
                                            <div class="row">
                                                <div id="calendar"></div>
                                            </div>

                                            <div class="row text-center" style="padding:20px 10px 0 10px;">


                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-footer text-center">
                                        <span id="forcheckend">
                                            <a id="btndraf" href="#" onclick="SaveData('Draft');return false;" class="btn btn-animated btn-primary">Save Draft <i class="fa fa-save"></i></a>
                                            <a id="btnsave" href="#" onclick="SaveData('Submit');return false;" class="btn btn-animated btn-success">Submit <i class="fa fa-calendar"></i></a>
                                        </span>
                                        <a id="btnback" href="#" onclick="window.location.href = '@Url.Action("TimeSheetView", "TimeSheet")';" class="btn btn-animated btn-warning">Back <i class="fa fa-undo"></i></a>
                                        <span class="pull-right">
                                            <a id="btnpmgr" href="#" onclick="performancemanagerbtn();return false;" class="btn btn-animated btn-gray">Change Performance Manager <i class="fa fa-user-circle"></i></a>
                                        </span>
                                    </div>
                                </div>
                            </div>


                            <!-- /.row -->
                        </section>
                        <!-- /.content -->
                    </div>

                </div>
            </div>
        </div>
    </div>
    <br>
</div>

<div id="PopupTimesheet" class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog  widthPOP">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #337ab7;">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <span class="modal-title">
                    <b style="color: white;">
                        <span class="fa fa-plus-circle"></span>&nbsp; Add time information
                    </b>
                </span>
            </div>
            <div class="modal-body">
                <div class="row text-center">
                    <div class="col-md-12">
                        <div style="border:1px solid #3c8dbc;padding:10px 0;margin:10px;border-radius:10px;">
                            <div class="row">
                                <div class="col-md-2"></div>
                                <div class="col-md-8 ">
                                    <div class="form-group-sm">
                                        <label class="contForRdo lb-type-green col-sm-12" for="rdoNH">
                                            <span class="fa fa-keyboard-o"></span>&nbsp; Normal Hour
                                            <input type="radio" checked="checked" id="rdoNH" name="radioType" value="NH" title="Normal Hour">
                                            <span class="checkmark"></span>
                                        </label>
                                    </div>
                                    <div class="form-group-sm">
                                        <label class="contForRdo lb-type-blue col-sm-12" for="rdoOT">
                                            <span class="fa fa-clock-o"></span>&nbsp; OT
                                            <input type="radio" id="rdoOT" name="radioType" value="OT" title="OT">
                                            <span class="checkmark"></span>
                                        </label>
                                    </div>
                                    <div class="form-group-sm">
                                        <label class="contForRdo lb-type-pink col-sm-12" for="rdoTN">
                                            <span class="fa fa-book"></span>&nbsp; Training
                                            <input type="radio" id="rdoTN" name="radioType" value="TN" title="Training">
                                            <span class="checkmark"></span>
                                        </label>
                                    </div>
                                    <div class="form-group-sm">
                                        <label class="contForRdo lb-type-orange col-sm-12" for="rdoSL">
                                            <span class="fa fa-hotel"></span>&nbsp; Sick Leave
                                            <input type="radio" id="rdoSL" name="radioType" value="SL" title="Sick Leave">
                                            <span class="checkmark"></span>
                                        </label>
                                    </div>
                                    <div class="form-group-sm">
                                        <label class="contForRdo lb-type-red col-sm-12" for="rdoVL">
                                            <span class="fa fa-plane"></span>&nbsp; Vacation Leave
                                            <input type="radio" id="rdoVL" name="radioType" value="VL" title="Vacation Leave">
                                            <span class="checkmark"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <hr />
                <div class="row" id="divforeggm">
                    <div class="col-md-12">
                        <div class="form-group form-group-sm row">
                            <label class="col-sm-5 col-form-label require text-right">Engagement Code </label>
                            <div class="col-sm-7">

                                <input id="txtEngagement" name="txtEngagement" class="form-control" type="search" list="engagement_lst" onchange="setvaltolabel(this);" required />

                                <datalist id="engagement_lst"></datalist>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="row">
                    <div class="col-md-12">
                        <div class="form-group form-group-sm row">
                            <label class="col-sm-5 col-form-label require text-right">
                                Period Of Time
                            </label>
                            <div class="col-sm-7 text-center">
                                <div class="input-daterange input-group">
                                    <span data-field="time" class="form-control input-group-addon" ID="txtTimeSheetStart_Date" style="border: 1px solid rgba(0, 0, 0, 0.15);
    border-radius: 0.25rem;"></span>

                                    @* <input type="text" class="input-sm form-control col-sm-5" ID="txtTimeSheetStart_Date" name="txtTimeSheetStart_Date"  data-field="time">*@
                                    <span class="input-group-addon col-sm-2">&nbsp;&nbsp;To</span>
                                    @*<input type="text" class="input-sm form-control col-sm-5" ID="txtTimeSheetEnd_Date" name="txtTimeSheetEnd_Date" data-field="time">*@
                                    <span data-field="time" class="form-control input-group-addon text-center" ID="txtTimeSheetEnd_Date" style="border: 1px solid rgba(0, 0, 0, 0.15);
    border-radius: 0.25rem;"></span>
                                    <div id="dtBox"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12">
                        <div class="form-group form-group-sm row">
                            <label class="col-sm-5 col-form-label nomallabel text-right">Remark </label>
                            <div class="col-sm-7">
                                <input type="text" class="form-control input-sm" id="txtRemark" name="txtRemark" maxlength="200" value="">
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="modal-footer">
                <button id="btnOK" type="button" onclick="addeven()" class="btn btn-primary" data-dismiss="modal">
                    <span class="fa fa-plus-circle"></span>&nbsp; Add
                </button>
                <button type="button" class="btn btn-danger" data-dismiss="modal"><span class="fa fa-times-circle"></span>&nbsp; Cancel</button>
            </div>
        </div>
    </div>
</div>
<div id="PopupAlertMsg" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog  widthPOP">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #337ab7;">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <span class="modal-title">
                    <b style="color: white;">
                        <span class="fa fa-warning"></span>&nbsp; System notification message
                    </b>
                </span>
            </div>
            <div class="modal-body text-center">
                <p id="textforalert" class="text-danger"><span class="fa fa-warning text-warning" style="font-size:20px;"></span>&nbsp; </p>
                @*<label id="id_even_remove" class="text-warning" style="font-size:25px;"></label>
                    <label id="id_even_remove_H" class="hidden" style="font-size:25px;"></label>*@


            </div>
            <div class="modal-footer">

                <button type="button" class="btn btn-danger" data-dismiss="modal"><span class="fa fa-times-circle"></span>&nbsp; Cancel</button>
            </div>
        </div>
    </div>
</div>

<div id="PopupDetailEven" class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog  widthPOP">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #337ab7;">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <span class="modal-title">
                    <b style="color: white;">
                        <span class="fa fa-info-circle"></span>&nbsp; Detail
                    </b>
                </span>
            </div>
            <div class="modal-body text-center">
                @*<p class="text-danger"><span class="fa fa-warning text-warning" style="font-size:20px;"></span>&nbsp; Are you sure you want to delete this information ?</p>*@
                <label id="id_even_detail" style="font-size: 20px;border: 1px solid #e2dede; border-radius: 10px;padding: 20px;text-align: center;line-height: 40px;width: 100%;color:#337ab7;"></label>

                <label id="id_even_remove" class="" style="font-size:25px;"></label>
                <label id="id_even_remove_H" class="" style="font-size:25px;"></label>
                <label id="id_even_remove_date" class="" style="font-size:25px;"></label>
                <label id="id_even_remove_title" class="" style="font-size:25px;"></label>
            </div>
            <div class="modal-footer">
                @*<button id="btnOK" type="button" onclick="removeeven()" class="btn btn-primary" data-dismiss="modal">
                        <span class="fa fa-trash-o"></span>&nbsp; Delete
                    </button>*@
                <button id="btnRemove" type="button" onclick="removeeven()" class="btn btn-warning" data-dismiss="modal">
                    <span class="fa fa-trash-o"></span>&nbsp; Delete
                </button>
                <button type="button" class="btn btn-danger" data-dismiss="modal"><span class="fa fa-times-circle"></span>&nbsp; Cancel</button>
            </div>
        </div>
    </div>
</div>
<!-- Page specific script -->

@section style{
    <link href="~/Scripts/plugins/dist/css/AdminLTE.css" rel="stylesheet" />
    <link href="~/Scripts/plugins/dist/css/skins/_all-skins.min.css" rel="stylesheet" />

    <link href="~/Scripts/plugins/fullcalendar/dist/fullcalendar.min.css" rel="stylesheet" />
    @*<link href="~/Scripts/plugins/fullcalendar/dist/fullcalendar.print.min.css" rel="stylesheet" />*@
    <link href="~/Scripts/plugins/DateTimePicker_Cus/dist/DateTimePicker.min.css" rel="stylesheet" />


    <style>

        .btn-warning {
            color: white;
        }

        .fc .fc-row .fc-content-skeleton table, .fc .fc-row .fc-content-skeleton td, .fc .fc-row .fc-helper-skeleton td {
            background: 0 0;
            border-color: #dddddd !important;
            margin: 5px 0;
            line-height: 50px;
            cursor: pointer;
        }

        #calendar {
            width: 100%;
            margin: 0 auto;
        }

        .fc-event-container {
            position: relative;
        }

        .closon {
            position: absolute;
            right: 0;
            cursor: pointer;
            background-color: #FFF;
            border: 1px solid white;
            border-radius: 50%;
            font-size: 5px;
            padding: 0 3px;
            margin-top: 5px;
        }

        .fc-slats tr {
            height: 5px !important;
        }

        .fc-widget-header {
            line-height: 50px;
            color: cadetblue;
        }

        .contForRdo {
            display: inline-table;
            position: relative;
            padding-left: 35px;
            margin-bottom: 12px;
            cursor: pointer;
            font-size: 16px;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            padding: 1px 40px;
            color: white;
            border-radius: 20px;
            border: 2px solid #337ab76b;
        }

            /* Hide the browser's default radio button */
            .contForRdo input {
                position: absolute;
                opacity: 0;
                cursor: pointer;
            }
        /* Create a custom radio button */
        .checkmark {
            position: absolute;
            top: 0;
            left: 0;
            height: 25px;
            width: 25px;
            background-color: #eee;
            border-radius: 50%;
        }

        /* On mouse-over, add a grey background color */
        .contForRdo:hover input ~ .checkmark {
            background-color: #ccc;
        }

        /* When the radio button is checked, add a blue background */
        .contForRdo input:checked ~ .checkmark {
            background-color: #0ecafe;
        }

        /* Create the indicator (the dot/circle - hidden when not checked) */
        .checkmark:after {
            content: "";
            position: absolute;
            display: none;
        }

        /* Show the indicator (dot/circle) when checked */
        .contForRdo input:checked ~ .checkmark:after {
            display: block;
        }

        /* Style the indicator (dot/circle) */
        .contForRdo .checkmark:after {
            top: 9px;
            left: 9px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: white;
        }

        .lb-type-green {
            background-color: #0ccc0c;
            color: white;
        }

        .lb-type-yellow {
            background-color: #dede14;
            color: white;
        }

        .lb-type-pink {
            background-color: #ff006a;
            color: white;
        }

        .lb-type-blue {
            background-color: #005aff;
            color: white;
        }

        .lb-type-orange {
            background-color: orange;
            color: white;
        }

        .lb-type-red {
            background-color: #b409df;
            color: white;
        }

        .fc-title {
            color: white;
            line-height: 25px;
        }

        .contForRdo input:checked ~ .checkmark {
            background-color: #a7a7a7;
        }

        input[data-field] {
            display: block;
            width: 100%;
            padding: 0.5rem 0.75rem;
            font-size: 1rem;
            line-height: 1.25;
            color: #495057;
            background-color: #fff;
            background-image: none;
            background-clip: padding-box;
            border: 1px solid rgba(0, 0, 0, 0.15);
            border-radius: 0.25rem;
            transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;
        }


        .dtpicker-buttonSet {
            background: rgb(60, 141, 188) !important;
            color: #FFF !important;
        }

        .dtpicker-buttonClear {
            background: orange !important;
            color: #FFF !important;
        }

        .fc-dailytotal {
            border-radius: 5px;
            background-color: #fafafa;
            width: 45px;
            height: 20px;
            padding: 0px 0px 5px 10px;
            line-height: 30px;
            border: 1px solid lightskyblue;
        }
    </style>
}



@section scripts{
    @*<script src="~/Scripts/plugins/jquery/dist/jquery.min.js"></script>
        <script src="~/Scripts/plugins/jquery-ui/jquery-ui.min.js"></script>*@
    <script src="~/Scripts/plugins/knockout-3.4.2.js"></script>
    <script src="~/Scripts/plugins/knockout.mapping-latest.js"></script>

    <!-- Slimscroll -->
    <script src="~/Scripts/plugins/jquery-slimscroll/jquery.slimscroll.min.js"></script>
    <!-- FastClick -->
    <script src="~/Scripts/plugins/fastclick/lib/fastclick.js"></script>
    <!-- AdminLTE App -->
    <script src="~/Scripts/plugins/dist/js/adminlte.min.js"></script>
    <!-- AdminLTE for demo purposes -->
    @*<script src="~/Scripts/plugins/dist/js/demo.js"></script>*@
    <!-- fullCalendar -->
    <script src="~/Scripts/plugins/moment/moment.js"></script>
    <script src="~/Scripts/plugins/fullcalendar/dist/fullcalendar.min.js"></script>

    <script src="~/Scripts/plugins/DateTimePicker_Cus/dist/DateTimePicker.min.js"></script>
    <script src="~/Scripts/plugins/DateTimePicker_Cus/src/i18n/DateTimePicker-i18n.js"></script>
    <script src="~/Scripts/plugins/jsLinq/linq.min.js"></script>
    <script src="~/Scripts/plugins/jsLinq/jquery.linq.min.js"></script>



    <script>
        var objModel = @Html.Raw(Json.Encode(Model));
        var lstforEven = "";
        var STAddEven;
        var EDAddEven;
       var newdata = new Array();

        var objEven = [];
        //list for K1-K4 and audit pool
        var lstdivcode_retain = ["14100058", "14100059", "14100060", "14100061", "14100062"];
        //Is Audit in list
        var checkcc = lstdivcode_retain.includes(objModel.division_code);

        $(document).ready(function () {
            BlockUI();
        if(objModel.active_status == "N")
        {
            $('#forcheckend').hide();
        }


            $("#dtBox").DateTimePicker();
            $.ajax({
                dataType: AjaxCall.dataType,
                type: AjaxCall.type,
                contentType: AjaxCall.contentType,
                url:'@Url.Action("GetEngagement", "TimeSheet")',
                data: JSON.stringify({ ItemData : "" }),
                    success: function (respone) {

                        var str = ''; // variable to store the options
                        newdata = new Array(respone);
                        for (var i = 0; i < newdata[0].length; ++i) {
                            str += '<option id="' + newdata[0][i].id + '" value="' + newdata[0][i].id + '" >'+ newdata[0][i].text +'</option>'; // Storing options in variable
                        }
                        var my_list = document.getElementById("engagement_lst");
                        my_list.innerHTML = str;

                },
                error: AjaxCall.error,
                complete: function (jqXHR, status) {//finaly
                    UnblockUI();

                }
            });

        $('#costcentershow').text(objModel.cost_center);
        $('#nameshow').text(objModel.name);
        $('#accountNo').text(objModel.account_no);
        $('#startdatelb').text(moment(objModel.date_start).format('DD MMMM YYYY'));
        $('#enddatelb').text(moment(objModel.date_end).format('DD MMMM YYYY'));
         $('#costcenterlb').text(objModel.cost_center);
            $('#rang_date_edit').text(moment(objModel.date_start).format('DD MMM YYYY') + ' - ' + moment(objModel.date_end).format('DD MMM YYYY'));
            if (objModel.active_status == 'N')
            {
                $('#btndraf').css('visibility', 'hidden');
                $('#btnsave').css('visibility', 'hidden');
                $('#btnpmgr').css('visibility', 'hidden');
            }


            
            if (!checkcc) {
                $("#btnpmgr").show();
            }
            else {
                $("#btnpmgr").hide();
            }

            });

        $('#txtTimeSheetStart_Date').on('DOMSubtreeModified', function () {
            var d = new Date(new Date().toDateString() + ' ' + $('#txtTimeSheetStart_Date').text());
            var thispoin = $radio = $('input[type="radio"]:checked');
            var settime;
            switch (thispoin.val()) {
                case "NH":
                    if (d.getHours() < 12) {
                        d.addHours(9);
                    }
                    else if (d.getHours() < 15) {
                        d.addHours(8);
                    }
                    else { d.addHours(23 - d.getHours()); }
                    break;
                case "TN":
                    d.addHours(9);
                    break;
                case "OT":
                case "SL":
                case "VL":
                    d.addHours(2);
                    break;
                default:
                // code block
            }
            settime = addZero(d.getHours()) + ':' + addZero(d.getMinutes());
            if ($('#txtTimeSheetEnd_Date').text() == "") {
                $('#txtTimeSheetEnd_Date').text(settime);
            }
        });
        $('#txtTimeSheetEnd_Date').on('DOMSubtreeModified', function () {
            var datetimeST = new Date(new Date().toDateString() + ' ' + $('#txtTimeSheetStart_Date').text());
            var datetimeED = new Date(new Date().toDateString() + ' ' + $('#txtTimeSheetEnd_Date').text());
            if ($('#txtTimeSheetEnd_Date').text() != '')
                if (diff($('#txtTimeSheetStart_Date').text(), $('#txtTimeSheetEnd_Date').text() ) > 10) {
                    DialogWarning(DialogHeader.Warning,'Normal Hour More than the system specified Please select other Type and add the remaining amount.');
                    $('#txtTimeSheetEnd_Date').text('');

                }

            if (datetimeED < datetimeST && $('#txtTimeSheetEnd_Date').text() != '') {

                DialogWarning(DialogHeader.Warning,'Invalid time period');
                $('#txtTimeSheetEnd_Date').text('');

            }

        })
        $('input[type="radio"]').on('change', function (e) {
            switch (this.value) {
                case "NH":
                case "OT":
                case "TN":
                    $('#txtEngagement').val('');
                    $('#txtEngagement').attr('readonly', false);
                    $('#divforeggm').show(500);
                    break;
                case "SL":
                    $('#txtEngagement').attr('readonly', true);
                    $('#txtEngagement').val('150000000001');
                    break;
                case "VL":
                    $('#txtEngagement').attr('readonly', true);
                    $('#txtEngagement').val('150000000000');
                    //$('#divforeggm').hide(900)
                    break;
                default:
                // code block
            }
            //alert(this.value);
        });
        Date.prototype.addHours = function (h) {
            this.setTime(this.getTime() + (h * 60 * 60 * 1000));
            return this;
        }
        function addZero(i) {
            if (i < 10) {
                i = "0" + i;
            }
            return i;
        }

        function diff(start, end) {
            start = start.split(":");
            end = end.split(":");
            var startDate = new Date(0, 0, 0, start[0], start[1], 0);
            var endDate = new Date(0, 0, 0, end[0], end[1], 0);
            var diff = endDate.getTime() - startDate.getTime();
            var hours = Math.floor(diff / 1000 / 60 / 60);
            diff -= hours * 1000 * 60 * 60;
            var minutes = Math.floor(diff / 1000 / 60);
            if (start[0] >= 12 && end[0] <= 13) {
                newset -= end[1];
                DialogWarning(DialogHeader.Warning,'You cannot select a start date or an end date in the duration of the lunch break.');
                $('#txtTimeSheetStart_Date').text('');
                $('#txtTimeSheetEnd_Date').text('');
                return false;
            }
            else if (start[0] == 12 && start[1] <= 59) {
                newset -= end[1];
                DialogWarning(DialogHeader.Warning,'Cannot add information during this time.');
                $('#txtTimeSheetStart_Date').text('');
                $('#txtTimeSheetEnd_Date').text('');
                $('#txtTimeSheetStart_Date').focus();
                return false;
            }
            else if (end[0] == 12 && end[1] > 0 && end[1] <= 59) {
                DialogWarning(DialogHeader.Warning,'Cannot add information during this time.');
                $('#txtTimeSheetStart_Date').text('');
                $('#txtTimeSheetEnd_Date').text('');
                $('#txtTimeSheetEnd_Date').focus();
                return false;
            }
            else if (start[0] <= 12 && end[0] < 13) {
                var setall = endDate.getTime() - startDate.getTime();
                hours = Math.floor(setall / 1000 / 60 / 60);
                setall -= hours * 1000 * 60 * 60;
                var newset = Math.floor(setall / 1000 / 60);
                if (start[0] == 12) {
                    newset -= start[1];
                }
                else if (end[0] == 12) {
                    newset -= end[1];
                }
                minutes = newset;
            }
            else if (start[0] <= 12 && end[0] >= 13)
            {
                hours -= 1;
            }


            var thispoin = $radio = $('input[type="radio"]:checked');
            if (hours >= 8 && thispoin.val() == "NH")
            {
                if ((hours == 8 && minutes > 0) || (hours > 8)) {
                    DialogWarning(DialogHeader.Warning,'Selected period More than the standard set.');
                    $('#txtTimeSheetEnd_Date').text('');
                }
            }



            return hours + ":"  + minutes;
        }

        function displayPopup() {
            if ($(document).width() >= 768)
                return false;
            else
                return true;
        }


        function isWorkday(year, month, day) {
            var date = day + '-' + month + '-' + year;
            var getdate = moment(date,"DD-MM-YYYY");


            var days = getdate._d.toString().split(' ')[0];

            //var getdates = moment(date, "dd-MM-yyyy").isBusinessDay();
            var holidays = objModel.lstData_holiday;
            var val = false;
            if (days != 'Sat' && days  != 'Sun') {
                for (var a = 0; a < holidays.length; a++) {
                    if (holidays[a].date == date) {
                        return  false;
                    }
                    else {
                        val = true;
                    }
                }

            }
            else { val = false;}

            return val;
        }

        $(function () {

            SetActiveMenu("timesheet");
            BindData(objModel);
            ko.applyBindings(viewModel);

            /* initialize the external events
             -----------------------------------------------------------------*/
            function init_events(ele) {
             
                ele.each(function () {

                    // create an Event Object (http://arshaw.com/fullcalendar/docs/event_data/Event_Object/)
                    // it doesn't need to have a start or end
                    var eventObject = {
                        title: $.trim($(this).text()),

                        // use the element's text as the event title
                    }

                    // store the Event Object in the DOM element so we can get to it later
                    $(this).data('eventObject', eventObject)

                    // make the event draggable using jQuery UI
                    //$(this).draggable({
                    //    zIndex: 1070,
                    //    revert: true, // will cause the event to go back to its
                    //    revertDuration: 0  //  original position after the drag
                    //})

                })
            }

            init_events($('#external-events div.external-event'))

            /* initialize the calendar
             -----------------------------------------------------------------*/
      
            //Date for the calendar events (dummy data)
            var lstdata = [];
            if (objModel.lstData_cld != undefined && objModel.lstData_cld != null && objModel.lstData_cld.length > 0) {
                lstdata = objModel.lstData_cld

            }
            var start_form = moment(objModel.date_start).format('YYYY-MM-DD');
            var end_form = moment(objModel.date_end).format('YYYY-MM-DD');
            var olddate = "";
            var sumOTOld = 0;
          var sumOT = 0;
            $('#calendar').fullCalendar({
                //axisFormat: 'h:mm T',
                defaultView: 'month',
                header: {
                    left: 'prev,next ',
                    center: 'title',
                    right: ''
                }, /*'agendaWeek,month'*/
                buttonText: {

                    month: 'Overview',
                    week: 'Time Sheet',
                    //day: 'Edit time period'
                },
                dayRender: function (date, cell) {
                    var start_select = date.format('YYYY-MM-DD');
                    if (start_select >= start_form && start_select <= end_form) {

                        //cell.css("background-color", "#FFF");
                    }

                    else {
                        cell.css("background-color", "#f1f1f1");
                    }
                },
                //dayClick: function (date, allDay, jsEvent, view) {

                //    var startset = "";
                //    var endset = "";
                //    var myDate = new Date();

                //    //How many days to add from today?
                //    var daysToAdd = 15;

                //    myDate.setDate(myDate.getDate() + daysToAdd);

                //    if (date < moment(myDate)) {
                //        //TRUE Clicked date smaller than today + daysToadd
                //        alert("You cannot book on this day!");
                //    }
                //    else {
                //        $("#id_even_remove").val(event._id);
                //        $("#id_even_remove_H").val(event.id);
                //        var titlesplit = event.title.split('|');
                //        $("#id_even_detail").html("<p style='color: #ffffff;background: " + event.backgroundColor + ";border-radius: 20px;'>" + titlesplit[0] + "<br>" + titlesplit[1] + "<br>" + titlesplit[2] + "<p> Date  : " + event.start.format("ddd DD MMM YYYY") + " <br>Start Time  : " + event.start.format("HH:mm") + " <br>End Time  : " + event.end.format("HH:mm"));
                //        $("#PopupDetailEven").modal();

                //        //FLASE Clicked date larger than today + daysToadd
                //        alert("Excellent choice! We can book today..");
                //    }


                //},
                //validRange: {
                //    start: '2019-04-03',
                //    end: '2019-04-06'
                //},
                events: lstdata,
                selectable: true,
                select: function (start, end, even) {
                    $("#PopupTimesheet").modal();
                    BlockUI;
                    STAddEven = start;
                    EDAddEven = end;
                    var newDate = moment(STAddEven.format());
                    // Inject it into the initial moment object
                    EDAddEven.set(newDate.toObject());

                    var start_select = start.format('YYYY-MM-DD');
                    //var end_select = end.format('YYYY-MM-DD');
                    if (start_select >= start_form && start_select <= end_form) {

                        var set = isWorkday(start_select.split('-')[0], start_select.split('-')[1], start_select.split('-')[2]);
                        if (set == false) {

                            $("input[value=OT]").prop("checked", true);

                            $("label[for='rdoNH']").css("display", "none");
                            $("label[for='rdoTN']").css("display", "none");
                            $("label[for='rdoSL']").css("display", "none");
                            $("label[for='rdoVL']").css("display", "none");
                        }
                        else {
                            $("label[for='rdoNH']").css("display", "inline-block");
                            $("label[for='rdoTN']").css("display", "inline-block");
                            $("label[for='rdoSL']").css("display", "inline-block");
                            $("label[for='rdoVL']").css("display", "inline-block");
                            


                            if (!checkcc ) {
                                $("label[for='rdoNH']").css("display", "inline-block");
                                $("label[for='rdoTN']").css("display", "inline-block");
                                $("label[for='rdoSL']").css("display", "inline-block");
                                $("label[for='rdoVL']").css("display", "inline-block");
                            }
                            else {
                                $("input[value=OT]").prop("checked", true);

                                $("label[for='rdoNH']").css("display", "none");
                                $("label[for='rdoTN']").css("display", "none");
                                $("label[for='rdoSL']").css("display", "none");
                                $("label[for='rdoVL']").css("display", "none");
                            }
                        }






                    }
                    //else if (start_select <= end_form)
                    //{

                    //    $("#PopupTimesheet").modal();
                    //}
                    else {
                        DialogWarning(DialogHeader.Warning, 'Can&rsquo;t select that date because it doesn&rsquo;t match intern&rsquo;s timesheet policy.');

                        //$("#PopupAlertMsg").modal();
                        //$("#textforalert").text("Can't select that date because it doesn't match trainee's timesheet policy. ")
                    }

                    UnblockUI();
                },
                //editable: false,
                disableDragging: true,
                displayEventTime: false,
                //allDay: false,
                //eventLimit: true,
                eventClick: function (event) {

                    $("#id_even_remove").val(event._id);
                    $("#id_even_remove_H").val(event.id);
                    $("#id_even_remove_date").val(event.start);
                    $("#id_even_remove_title").val(event.title);
                    var titlesplit = event.title.split('|');




                    var engatename = "";
                    if(titlesplit[2] == "150000000001" || titlesplit[2] == "150000000000")
                    {}
                    else
                    {
                            var objengate = Enumerable.From(newdata[0]).Where(function (w) { return w.id == titlesplit[2] }).FirstOrDefault();
                            if(objengate != null){ engatename = objengate.name;}
                    }
                    var remarks = "";
                    if (titlesplit[3] != undefined) {
                        remarks = "Remark : " + titlesplit[3];
                    }


                    $("#id_even_detail").html("<p style='color: #ffffff;background: " + event.backgroundColor + ";border-radius: 20px;'>" + titlesplit[1] + "</p> Date  : " + event.start.format("ddd DD MMM YYYY") + " <br>Start Time  : " + event.start.format("HH:mm") + " <br>End Time  : " + event.end.format("HH:mm") + "<br>Total : " + titlesplit[0].replace(':', '.') + " Hrs. <hr>Engagement Code : " + titlesplit[2] + " <br>Engagement Manager : " + engatename +"<hr>"+ remarks);


                    if (event.backgroundColor == "#bfe87c" || event.backgroundColor == "#7ce8d4" || event.backgroundColor == "#c78be6" || event.backgroundColor == "#f380ef") {
                        $('#btnRemove').hide();
                    }
                    else {
                        $('#btnRemove').show();
                    }
                    $("#PopupDetailEven").modal();
                },
                eventRender: function (event, element, view) {
                    //เพิ่ม ฟังชั่นการ ลบ
                    //if (view.name == 'listDay') {
                    //    element.find(".fc-list-item-time").append("<span class='closon'>X</span>");
                    //} else {
                    //    element.find(".fc-content").prepend("<span class='closon'>X</span>");
                    //}
                    //element.find(".closon").on('click', function () {
                    //    $("#id_even_remove").text('" ' + event.title + ' "');
                    //    $("#id_even_remove").val(event._id);
                    //    $("#id_even_remove_H").val(event.id);
                    //    //$("#PopupRemoveEven").modal()
                    //    //if ( == true) {
                    //    //    $('#calendar').fullCalendar('removeEvents', function (searchEvent) {
                    //    //        return searchEvent._id === event._id;
                    //    //    });
                    //    //    $("#id_even_remove").modal('hide');
                    //    //}
                    //});
                },
                viewRender: function (view, element) {
                    $.each($(".fc-day-top"), function (key, val) {
                        var dateYMD = $(this).attr("data-date");
                        $(this).append("<div class='fc-dailytotal' id='dailytotal-" + dateYMD + "'></div>");
                    });
                },

                eventRender: function (event, element, view) {
                    $(".fc-dailytotal").text(0); //Clear total sum
                    //event.totalhrs = event.title.split('|')[0].replace(':', '.');

                },

                eventAfterRender: function (event, element, view) {
                    var currentday = moment(event.start).format("YYYY-MM-DD");


                    //if (event.totalhrs == undefined)
                    //    event.totalhrs = 0;
                    event.totalhrs = event.title.split('|')[0].replace(':', '.');


                    sumOT = 0;


                    if (event.title.split('|')[1] == "OT") {
                        sumOT += parseFloat(event.totalhrs);
                    }

                    if (olddate != currentday) {
                        sumOTOld = 0;
                    }
                    else {
                        sumOT += parseFloat(event.totalhrs);
                    }
                    sumOTOld += sumOT;

                    olddate = currentday;

                    //var ss =  event.Date;
                    if (event.totalhrs > 0) {
                        var prev = $("#dailytotal-" + currentday).text() || 0.00;
                        var sum = (+prev + +event.totalhrs).toFixed(2);
                        var st = timestrToSec(prev > 0 ? prev.replace('.', ':') + ":00" : "00:00:00");
                        var ed = timestrToSec(event.totalhrs.replace('.', ':') + ":00");
                        //var setnew = sum.split('.');
                        //if (setnew[1]>=60)
                        //{
                        //    sum = (setnew[0] + 1) + ".00";
                        //}

                        var s = formatTime(st + ed);

                        $("#dailytotal-" + currentday).text(sum);
                        if (Number(sum) < 8) {
                            $("#dailytotal-" + currentday).css("background-color", "rgb(249, 175, 175)");
                        }
                        else if (Number(sum) == 8) {
                            $("#dailytotal-" + currentday).css("background-color", "white");
                        }


                        else if (Number(sum) - Number(sumOTOld) > 8) {
                            DialogWarning(DialogHeader.Warning, 'please check the number of your working hours, working hours beyond eighth hour must be recorded as OT.');
                            $("#dailytotal-" + currentday).css("background-color", "white");
                            return false;
                        }
                    }
                },


                })

        })
        function timestrToSec(timestr) {
            var parts = timestr.split(":");
            return (parts[0] * 3600) +
                (parts[1] * 60) +
                (+parts[2]);
        }

        function pad(num) {
            if (num < 10) {
                return "" + num;
            } else {
                return "" + num;
            }
        }

        function formatTime(seconds) {
            return [pad(Math.floor(seconds / 3600)),
            pad(Math.floor(seconds / 60) % 60),
            ].join(":");
        }
        function addeven() {
            var EggmCode = $('#txtEngagement').val();
            var datetimeST = $('#txtTimeSheetStart_Date').text();
            var datetimeED = $('#txtTimeSheetEnd_Date').text();
            if (EggmCode == '') {
                DialogWarning(DialogHeader.Warning, 'Please fill in the Engagement Code.');
                return false;
            }
            if (datetimeST == '' || datetimeED == '')
            {
                DialogWarning(DialogHeader.Warning,'Please choose the time period.');
                return false;
            }

            var NofHour = diff(datetimeST, datetimeED);
            if (NofHour == false) {
                return false;
            } else {
                var setsub = NofHour.split(':');
                if (setsub[1] == "30")
                {
                    NofHour = setsub[0]+":5"
                }
                var Remark = GetValueTextBox("txtRemark");

                var thispoin = $radio = $('input[type="radio"]:checked');
                var title = thispoin.attr('title');
                STAddEven.time(datetimeST, 'HH:mm');
                EDAddEven.time(datetimeED, 'HH:mm');
                //STAddEven.set(datetimeST, 'HH:mm');
                //EDAddEven.set(datetimeED, 'HH:mm');
                title = NofHour + '|' + title;
                if (EggmCode != '') {
                    title += '|' + EggmCode;
                }
                if (Remark != '') {
                    title += '|' + Remark;
                }
                var eventData;
                switch (thispoin.val()) {
                    case "NH":
                        eventData = {
                            allDay: false,
                            title: title,
                            start: STAddEven,
                            end: EDAddEven,
                            backgroundColor: $(".lb-type-green").css("background-color"),
                            borderColor: "",

                        };
                        break;
                    case "OT":
                        eventData = {
                            allDay: false,
                            title: title,
                            start: STAddEven,
                            end: EDAddEven,
                            backgroundColor: $(".lb-type-blue").css("background-color"),
                            borderColor: ""
                        };
                        break;
                    case "TN":
                        eventData = {
                            allDay: false,
                            title: title,
                            start: STAddEven,
                            end: EDAddEven,
                            backgroundColor: $(".lb-type-pink").css("background-color"),
                            borderColor: ""
                        };
                        break;
                    case "SL":
                        eventData = {
                            allDay: false,
                            title: title,
                            start: STAddEven,
                            end: EDAddEven,
                            backgroundColor: $(".lb-type-orange").css("background-color"),
                            borderColor: ""
                        };
                        break;
                    case "VL":
                        eventData = {
                            allDay: false,
                            title: title,
                            start: STAddEven,
                            end: EDAddEven,
                            backgroundColor: $(".lb-type-red").css("background-color"),
                            borderColor: ""
                        };
                        break;
                    default:
                    // code block
                }
                if (true) {
                    var objnew = {
                        id: eventData.id,
                        title: eventData.title,
                        start: eventData.start.format('YYYY-MM-DD HH:mm'),
                        end: eventData.end.format('YYYY-MM-DD HH:mm'),
                        allDay: eventData.allDay,
                        backgroundColor: eventData.backgroundColor
                    };
                    var boolcheck = true;
                    objModel.lstData_cld.forEach(function (entry) {
                        var newstartdate = moment(objnew.start);
                        var newenddate = moment(objnew.end);
                        var inliststdate = moment(entry.start);
                        var inlisteddate = moment(entry.end);
                        if (newstartdate >= inliststdate && newenddate <= inlisteddate) {

                            DialogWarning(DialogHeader.Warning, 'There is a duplication of time on the ' + newstartdate.format('DD MMM YYYY HH:mm') + ' - ' + newenddate.format('HH:mm') + ' Please check again.', 'func');
                            boolcheck = false;
                        }

                    });
                    if (boolcheck) {
                        $('#calendar').fullCalendar('renderEvent', eventData, true);


                        objModel.lstData_cld.push(objnew);
                        ko.mapping.fromJS(objModel.lstData_cld, {}, viewModel.lstData_cld);
                        BindData(objModel);
                    } else {
                        return false;
                    }
                }
            }
        }
        function removeeven(id)
        {
            var idin = $("#id_even_remove_H").val();
            var idindate = $("#id_even_remove_date").val();
            var idintitle = $("#id_even_remove_title").val();
            id = $("#id_even_remove").val();
            $('#calendar').fullCalendar('removeEvents', function (searchEvent) {

                return searchEvent._id === id;
            });

            var newlist = [];
            var date = moment(idindate, "DD/MM/YYYY");


            var result = $.grep(objModel.lstData_cld, function (e) {
                    var startTime = new Date(toValidDate(moment(idindate, 'YYYY-MM-DD HH:mm').format('DD/MM/YYYY HH:mm')));
                    var endTime = new Date(toValidDate(moment(e.start, 'YYYY-MM-DD HH:mm').format('DD/MM/YYYY HH:mm')));

                if (startTime + e.title !== endTime + idintitle) {
                        return e;
                    }
            });

            function toValidDate(datestring) {
                return datestring.replace(/(\d{2})(\/)(\d{2})/, "$3$2$1");
            }

            objModel.lstData_cld = result;
            ko.mapping.fromJS(objModel.lstData_cld, {}, viewModel.lstData_cld);
            BindData(objModel);
        }

        function SaveData(type)
        {

            var Param = GetData();
            if (type == 'Draft') { }
             $.ajax({
                dataType: AjaxCall.dataType,
                type: AjaxCall.type,
                async: false,
                contentType: AjaxCall.contentType,
                 url: '@Url.Action("SaveTimeSheet", "TimeSheet")',
                 data: JSON.stringify({ ItemData : Param,types : type }),
                success: function (respone) {
                     if (respone.result.Status == SysProcess.SessionExpired) {
                             PopupLogin('@Url.Action("Index", "Home")');
                        } else if (respone.result.Status == SysProcess.Success) {
                            DialogSuccessOk(DialogHeader.Info, DialogMsg.SaveComplete, 'func', function () {
                                 window.location.reload(true);
                            });
                        }
                        else if (respone.result.Status == SysProcess.Duplicate) {
                            DialogWarning(DialogHeader.Warning, respone.result.Msg);
                        }
                        else {
                            DialogWarning(DialogHeader.Warning, respone.result.Msg);
                    }
                    UnblockUI();
                },
                error: AjaxCall.error,
                complete: function (jqXHR, status) {//finaly
                    UnblockUI();
                }
             });
        }
        function performancemanagerbtn()
        {
            BlockUI();
            window.location.href = '@Url.Action("TimeSheetCreate", "TimeSheet")?qryStr=' + objModel.IdEncrypt;
        }

        function GetData() {


            var lstData = ko.toJS(viewModel);

            return lstData;
        }

        function setvaltolabel(val)
        {
            $('engagement_name').text(val.text);
        }

    </script>

    @*Script for bind Data KnockOut*@
    <script type="text/javascript">
        var viewModel = {

        };
        function ViewModel() {
            var self = this;
            self.conditionChecked = ko.observable(false);
            self.loadCondition = function () {
                //ajax request to get condition value. Suppose ajax request returned value "used". so
                self.conditionChecked("used");
            }
            self.loadCondition();
            ko.bindingHandlers.iCheck = { // integrating icheck plugin using bh

                init: function (element, valueAccessor) {
                    var ctrl = $(element);
                    var sID = ctrl[0].id;
                    //initialize icheck to the element
                    $(element).iCheck({
                        radioClass: 'iradio_flat-green'
                    });
                    $(element).on('ifChecked', function (event) {

                        var observable = valueAccessor();
                        observable.checked(event.target.defaultValue); //assigning selected value

                    });

                },
                update: function (element, valueAccessor) {
                    var observable = valueAccessor();
                }
            };
        }
        function BindData(value) {
            if (viewModel == undefined) {
                viewModel = ko.mapping.fromJS(value);
                ViewModel();

            }
            else {
                ko.mapping.fromJS(value, {}, viewModel);

            }
        }

    </script>
}
